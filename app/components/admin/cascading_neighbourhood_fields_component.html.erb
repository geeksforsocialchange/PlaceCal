<div class="nested-fields py-3 bg-base-200 rounded-lg mb-2"
     data-controller="cascading-neighbourhood"
     data-cascading-neighbourhood-selected-id-value="<%= form.object&.neighbourhood_id %>">

  <div class="flex gap-2 items-end">
    <div class="grid grid-cols-1 sm:grid-cols-5 gap-2 flex-1">
      <%# Country selector (level 5) %>
      <fieldset class="fieldset">
        <legend class="fieldset-legend text-xs"><%= t('admin.cascading_neighbourhood.country') %></legend>
        <select class="select select-bordered select-sm w-full"
                data-cascading-neighbourhood-target="country"
                data-action="change->cascading-neighbourhood#countryChanged">
          <option value=""><%= t('admin.labels.loading') %></option>
        </select>
      </fieldset>

      <%# Region selector (level 4) %>
      <fieldset class="fieldset">
        <legend class="fieldset-legend text-xs"><%= t('admin.cascading_neighbourhood.region') %></legend>
        <select class="select select-bordered select-sm w-full"
                data-cascading-neighbourhood-target="region"
                data-action="change->cascading-neighbourhood#regionChanged"
                disabled>
          <option value=""><%= t('admin.cascading_neighbourhood.select_region') %></option>
        </select>
      </fieldset>

      <%# County selector (level 3) %>
      <fieldset class="fieldset">
        <legend class="fieldset-legend text-xs"><%= t('admin.cascading_neighbourhood.county') %></legend>
        <select class="select select-bordered select-sm w-full"
                data-cascading-neighbourhood-target="county"
                data-action="change->cascading-neighbourhood#countyChanged"
                disabled>
          <option value=""><%= t('admin.cascading_neighbourhood.select_county') %></option>
        </select>
      </fieldset>

      <%# District selector (level 2) %>
      <fieldset class="fieldset">
        <legend class="fieldset-legend text-xs"><%= t('admin.cascading_neighbourhood.area') %></legend>
        <select class="select select-bordered select-sm w-full"
                data-cascading-neighbourhood-target="district"
                data-action="change->cascading-neighbourhood#districtChanged"
                disabled>
          <option value=""><%= t('admin.cascading_neighbourhood.select_area') %></option>
        </select>
      </fieldset>

      <%# Ward selector (level 1) %>
      <fieldset class="fieldset">
        <legend class="fieldset-legend text-xs"><%= t('admin.cascading_neighbourhood.ward') %></legend>
        <select class="select select-bordered select-sm w-full"
                data-cascading-neighbourhood-target="ward"
                data-action="change->cascading-neighbourhood#wardChanged"
                disabled>
          <option value=""><%= t('admin.cascading_neighbourhood.select_ward') %></option>
        </select>
      </fieldset>
    </div>

    <div class="flex items-center gap-1 pb-1">
      <span class="loading loading-spinner loading-xs hidden" data-cascading-neighbourhood-target="loading"></span>
      <% if show_remove %>
        <%= helpers.nested_form_remove_link(form, icon(:trash, size: '4'), class: 'btn btn-ghost btn-sm btn-square text-error') %>
      <% end %>
    </div>
  </div>

  <% if relation_type.present? %>
    <%= form.hidden_field :relation_type, value: relation_type %>
  <% end %>
  <%= form.hidden_field :neighbourhood_id, data: { cascading_neighbourhood_target: "output" } %>
</div>
