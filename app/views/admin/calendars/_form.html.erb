<p class="mb-6">
  <%= link_to "View this calendar",
      admin_calendar_path(@calendar.id),
      class: "inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-md text-white bg-placecal-orange hover:bg-orange-600" unless @calendar.new_record? %>
</p>

<%= render('importer_overview', calendar: @calendar) %>
<hr class="my-6 border-gray-200">

<div id="js-calendar-form">
  <%= simple_form_for [:admin, @calendar] do |f| %>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <h3 class="text-lg font-medium text-gray-900 mb-4">Details</h3>

        <%= f.association :partner,
                          label: 'Partner Organiser',
                          collection: options_for_organiser,
                          selected: (@partner&.id || @calendar.partner_id).to_s,
                          input_html: { data: {controller: "tom-select"} },
                          hint: 'Which group organises these events?' %>

        <%= f.input :name, hint: 'A simple description to help rememember what this calendar is' %>
        <%= f.input :source, label: 'URL', placeholder: 'https://your-domain.com/events.ics', hint: t('admin.calendars.handbook_hint_html') %>
        <%= f.input :importer_mode,
          collection: options_for_importer,
          default: 'auto' %>


        <div class='text-sm text-gray-500 mt-4'>
          <p class="mb-2">
            Calendar source URLs that PlaceCal currently supports are:
          </p>
          <ul class="list-disc pl-6 space-y-1">
          <% calendar_import_sources do |name, domains| -%>
            <li><%= name %> (<%= domains.join(', ') %>)</li>
          <% end -%>
          </ul>
        </div>
        <% if @calendar.importer_used.present? -%>
          <p class="text-sm text-gray-600 mt-4">The calendar was last imported using the <%= @calendar.importer_used %> importer.</p>
        <% end -%>

      </div>
      <div>
        <h3 class="text-lg font-medium text-gray-900 mb-4">Location</h3>
        <div v-if="locationVisible">
          <%= f.association :place,
                            label: 'Default location',
                            collection: options_for_location,
                            input_html: { data: {controller: "tom-select"} } %>
        </div>
        <%= f.input :strategy,
                    as: :radio_buttons,
                    label: 'Where should location information for this calendar come from?',
                    label_method: ->(val){strategy_label(val)},
                    input_html: { 'v-model': 'strategy', 'v-on:change': "updateLocation" } %>
      </div>
    </div>

    <hr class="my-6 border-gray-200">

    <h3 class="text-lg font-medium text-gray-900 mb-4">Public Contact Information</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <p class="text-sm text-gray-600 mb-4">
          This information is used on the <em>public</em>
          event listing pages in the "Problem with this listing? Let us know."
          contact link at the bottom of the show event page.
        </p>

        <%= f.input :public_contact_name %>
        <%= f.input :public_contact_email %>
        <%= f.input :public_contact_phone %>
      </div>
    </div>

    <hr class="my-6 border-gray-200">
    <div class="flex items-center gap-4">
      <%= f.button :submit, class: "inline-flex items-center px-4 py-2 text-sm font-medium rounded-md text-white bg-placecal-orange hover:bg-orange-600" %>
      <% unless @calendar.new_record? %>
        <%= link_to "Destroy Calendar", admin_calendar_path(@calendar), method: :delete, class: "inline-flex items-center px-4 py-2 text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700" %>
      <% end %>
    </div>
  <% end %>
</div>
