<%= render partial: 'layouts/admin/datatable', locals: {
    title: 'Neighbourhoods',
    model: :neighbourhoods,
    column_titles: [
      'Neighbourhood',
      'Type',
      'Hierarchy',
      'Partners',
      'Release',
      ''
    ],
    columns: %i[name unit hierarchy partners_count release_date actions],
    column_config: {
      name: {},
      unit: { fit: true },
      hierarchy: { sortable: false },
      partners_count: { fit: true },
      release_date: { fit: true },
      actions: { sortable: false, fit: true }
    },
    default_sort: { column: 'partners_count', direction: 'desc' },
    filters: [
      {
        column: 'country_id',
        label: 'Country',
        width: 'w-40',
        options: Neighbourhood.countries.latest_release.order(:name).map { |n|
          { value: n.id, label: n.name }
        }
      },
      {
        column: 'unit',
        label: 'Type',
        width: 'w-32',
        options: [
          { value: 'ward', label: 'Ward' },
          { value: 'district', label: 'District' },
          { value: 'county', label: 'County' },
          { value: 'region', label: 'Region' },
          { value: 'country', label: 'Country' }
        ]
      },
      {
        column: 'release',
        label: 'Release',
        width: 'w-32',
        default: 'current',
        options: [
          { value: 'current', label: 'Current' },
          { value: 'legacy', label: 'Legacy' }
        ]
      }
    ],
    data: @neighbourhoods,
    source: admin_neighbourhoods_path(current_user: @current_user, format: :json)
  }
%>

<h2 class="text-xl font-semibold text-gray-900 mt-8 mb-4">Neighbourhood Roots</h2>

<div class="bg-white shadow-sm rounded-lg p-4">
  <% Neighbourhood.roots.order(:name).each do |root| %>
    <p class="mb-2"><%= link_to safe_neighbourhood_name(root), admin_neighbourhood_path(root), class: "text-placecal-orange hover:underline" %></p>
  <% end %>
</div>

<p class="text-sm text-gray-500 mt-4">ONS Latest Release Date Loaded: <%= Neighbourhood::LATEST_RELEASE_DATE %></p>
