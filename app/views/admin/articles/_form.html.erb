<%= simple_form_for [:admin, @article], html: { class: 'space-y-6', data: { controller: 'form-tabs live-validation', 'form-tabs-storage-key-value': 'articleTabAfterSave' } } do |f| %>

  <%= render(Admin::ErrorComponent.new(@article)) %>

  <% if @article.new_record? %>
    <%# New record - single page layout %>
    <div class="card bg-base-100 border border-base-300 shadow-sm">
      <div class="card-body p-6">
        <%= render 'admin/articles/form_tab_text', f: f %>
      </div>
    </div>

    <div class="card bg-base-100 border border-base-300 shadow-sm">
      <div class="card-body p-6">
        <%= render Admin::SectionHeaderComponent.new(
          title: "Image",
          description: "Image will be cropped to 16:9 ratio.",
          margin: 4
        ) %>
        <%= render 'admin/articles/form_tab_image', f: f %>
      </div>
    </div>

    <div class="card bg-base-100 border border-base-300 shadow-sm">
      <div class="card-body p-6">
        <%= render Admin::SectionHeaderComponent.new(
          title: "References",
          description: "Link this article to partners and partnerships.",
          margin: 4
        ) %>
        <%= render 'admin/articles/form_tab_references', f: f %>
      </div>
    </div>

    <%= render Admin::SaveBarComponent.new do |c| %>
      <% c.with_button do %>
        <%= f.submit t('admin.actions.save'), class: "btn bg-placecal-orange hover:bg-orange-600 text-white border-placecal-orange" %>
      <% end %>
    <% end %>
  <% else %>
    <%# Existing record - tabbed interface %>
    <%= render Admin::TabFormComponent.new(
      tabs: [
        { label: 'ðŸ“ Text', hash: 'text', partial: 'admin/articles/form_tab_text' },
        { label: 'ðŸ–¼ï¸ Image', hash: 'image', partial: 'admin/articles/form_tab_image' },
        { label: 'ðŸ”— References', hash: 'references', partial: 'admin/articles/form_tab_references' },
        { label: 'âš™ï¸ Settings', hash: 'settings', partial: 'admin/articles/form_tab_settings', spacer_before: true }
      ],
      tab_name: 'article_tabs',
      storage_key: 'articleTabAfterSave',
      settings_hash: 'settings',
      form: f,
      record: @article
    ) %>
  <% end %>
<% end %>
